import{_ as w,l as S,b as n,c as l,d as o,t as r,n as I,j as g,h as y,k as T,m as L,F as k,e as _,C as d,p as c,f as u,q as p,r as C,o as N,s as v}from"./index-1d20f0bf.js";const E=S({name:"App",computed:{CONSTANTS(){return d}},data(){return{showPageUpButton:!1,newComment:"",editIndex:-1,editedComment:""}},mounted(){window.addEventListener("scroll",this.handleScroll)},destroyed(){window.removeEventListener("scroll",this.handleScroll)},methods:{copyLink(){const e=document.createElement("textarea");e.value=window.location.href,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),alert("링크가 복사되었습니다.")},toggleMode(){this.isDarkMode=!this.isDarkMode},async deletePost(){const e=JSON.parse(c.getLocalStorage(d.KEY_LIST.USER_INFO)),t=await u("board/deleteBoard",{userIdx:e.userIdx,postId:location.search});t.resultCode===1?(alert("글을 삭제했습니다."),await p.push("/")):t.resultCode===0&&t.error==="게시물 삭제 오류"?alert("본인의 글만 삭제할 수 있습니다."):alert("삭제 권한이 없습니다.")},async goToUpdateEdit(){const e=JSON.parse(c.getLocalStorage(d.KEY_LIST.USER_INFO)),t={id:location.search},i=await u("board/goToUpdateEdit",{userIdx:e.userIdx,postId:t.id});i.resultCode===1?await p.push({name:"UpdateEdit",query:t}):i.resultCode===0&&i.error==="게시물 수정 오류"?alert("본인의 글만 수정할 수 있습니다."):alert("수정 권한이 없습니다.")},async submitComment(){const e=this.newComment,t=JSON.parse(c.getLocalStorage(d.KEY_LIST.USER_INFO));(await u("board/writeComment",{commentContents:e,userIdx:t.userIdx,postId:location.search})).resultCode===1?(alert("댓글 작성 완료!"),await p.go(0)):alert("댓글이 저장되지 않았습니다.")},async deleteComment(){const e=JSON.parse(c.getLocalStorage(d.KEY_LIST.USER_INFO)),t=await u("board/deleteComment",{userIdx:e.userIdx,postId:location.search});t.resultCode===1?(alert("댓글을 삭제했습니다."),await p.go(0)):t.resultCode===0&&t.error==="게시물 삭제 오류"?alert("본인의 글만 삭제할 수 있습니다."):alert("삭제 권한이 없습니다.")},handleScroll(){const e=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;this.showPageUpButton=e>1},scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}},setup(){const e=C(!1);let t=`hsl(${parseInt(Math.random()*24,10)*15}, 16%, 75%)`;const i=JSON.parse(c.getLocalStorage(d.KEY_LIST.USER_INFO)),m=C({}),f=async()=>{await v("board/getBoardDetail",location.search).then(a=>{a?(m.value=a.data,i.userIdx===m.value.userEmail&&(e.value=!0)):alert("게시물 정보를 불러올 수 없습니다.")}).catch(a=>{console.log(a),alert("게시물 정보를 불러오는 중에 오류가 발생했습니다.")})},h=C({}),s=async()=>{await v("board/getCommentList",location.search).then(a=>{if(a){h.value=a.data;for(let b in a.data)a.data[b].color=t}else alert("댓글 정보를 불러올 수 없습니다.")}).catch(a=>{console.log(a),alert("댓글 정보를 불러오는 중에 오류가 발생했습니다.")})};return N(()=>{f(),s()}),{boardData:m,commentData:h,auth:e,colors:t}}}),U={class:"postmain-container"},D={class:"title"},O={class:"info-section"},B={class:"meta-info"},P={class:"circle"},M=["src"],A={class:"actions"},$={class:"contents"},F={class:"comments-container"},R={class:"comments-count"},Y=o("button",{class:"action-button",type:"submit"},"작성",-1),J={class:"comments-section-box"},K={class:"circle"},q=["src"],V={class:"meta-info"},z={class:"comments-contents"},j={class:"actions",id:"comment"},H=["onClick"],G={class:"page"},Q=o("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 384 512"},[o("path",{d:"M350 177.5c3.8-8.8 2-19-4.6-26l-136-144C204.9 2.7 198.6 0 192 0s-12.9 2.7-17.4 7.5l-136 144c-6.6 7-8.4 17.2-4.6 26s12.5 14.5 22 14.5h88l0 192c0 17.7-14.3 32-32 32H32c-17.7 0-32 14.3-32 32v32c0 17.7 14.3 32 32 32l80 0c70.7 0 128-57.3 128-128l0-192h88c9.6 0 18.2-5.7 22-14.5z"})],-1),W=[Q];function X(e,t,i,m,f,h){return n(),l("div",U,[o("div",D,r(e.boardData.boardTitle),1),o("div",O,[o("div",B,[o("div",P,[e.boardData.profileImg!==null?(n(),l("img",{key:0,src:e.CONSTANTS.API_URL+e.boardData.profileImg,alt:""},null,8,M)):(n(),l("div",{key:1,class:"exchangeImg",style:I(`background-color: ${e.colors}`)},null,4))]),o("p",null,"by "+r(e.boardData.userName),1),o("p",null,r(e.boardData.writeTime),1)]),o("div",A,[e.auth?(n(),l("button",{key:0,class:"action-button",onClick:t[0]||(t[0]=(...s)=>e.goToUpdateEdit&&e.goToUpdateEdit(...s))}," 수정 ")):g("",!0),e.auth?(n(),l("button",{key:1,class:"action-button",onClick:t[1]||(t[1]=(...s)=>e.deletePost&&e.deletePost(...s))}," 삭제 ")):g("",!0),o("button",{class:"action-button",onClick:t[2]||(t[2]=(...s)=>e.copyLink&&e.copyLink(...s))},"공유")])]),o("div",$,r(e.boardData.boardContents),1),o("div",F,[o("div",R,r(e.commentData.length)+"개의 댓글",1),o("form",{onSubmit:t[4]||(t[4]=y((...s)=>e.submitComment&&e.submitComment(...s),["prevent"]))},[T(o("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=s=>e.newComment=s),placeholder:"댓글을 입력하세요"},null,512),[[L,e.newComment]]),Y],32),(n(!0),l(k,null,_(e.commentData,(s,a)=>(n(),l("div",{class:"comments-section",key:a},[o("div",J,[o("div",K,[s.profileImg!==null?(n(),l("img",{key:0,src:e.CONSTANTS.API_URL+s.profileImg,alt:""},null,8,q)):(n(),l("div",{key:1,class:"exchangeImg",style:I(`background-color: ${s.color}`)},null,4))]),o("div",V,r(s.userName),1),o("div",z,r(s.commentContents),1)]),o("div",j,[o("p",null,r(s.writeTime),1),o("div",null,[o("button",{onClick:b=>e.deleteComment(a),class:"action-button"}," 삭제 ",8,H)])])]))),128))]),o("div",G,[e.showPageUpButton?(n(),l("button",{key:0,onClick:t[5]||(t[5]=(...s)=>e.scrollToTop&&e.scrollToTop(...s))},W)):g("",!0)])])}const x=w(E,[["render",X]]);export{x as default};
